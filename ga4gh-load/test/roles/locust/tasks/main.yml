---
- name: download locustfile.py
  get_url: url={{ locustfile_url }} dest={{ playbook_dir }}/locustfile.py force=yes
  when: locustfile_url is defined

- name: start locust
  docker:
    image: ljishen/locust
    name: locust
    state: reloaded
    volumes: /tmp/locustfile.py:/root/locustfile.py:ro
    entrypoint: locust --host={{ server[0] }}
